(this["webpackJsonpsg-demo"]=this["webpackJsonpsg-demo"]||[]).push([[26],{1288:function(e,a,t){"use strict";t.r(a);var r=t(42),n=t(43),c=t(53),s=t(52),l=t(0),u=t.n(l),o=t(1278),i=t(159),d=t(1280),f=t(209),p=t(192),h=t(743),m=t.n(h),v=d.a.Dragger,b=function(e){var a,t=[],r=m.a.utils.decode_range(e["!ref"]),n=r.s.r;for(a=r.s.c;a<=r.e.c;++a){var c=e[m.a.utils.encode_cell({c:a,r:n})],s="UNKNOWN "+a;c&&c.t&&(s=m.a.utils.format_cell(c)),t.push(s)}return t},g=function(e){return/\.(xlsx|xls|csv)$/.test(e.name)},x=function(e){Object(c.a)(t,e);var a=Object(s.a)(t);function t(){var e;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=a.call.apply(a,[this].concat(c))).state={loading:!1,excelData:{header:null,results:null}},e.draggerProps=function(){var a=Object(i.a)(e);return{name:"file",multiple:!1,accept:".xlsx, .xls",onChange:function(e){var a=e.file.status;"done"===a?f.a.success("".concat(e.file.name," \u6587\u4ef6\u4e0a\u4f20\u6210\u529f")):"error"===a&&f.a.error("".concat(e.file.name," \u6587\u4ef6\u4e0a\u4f20\u5931\u8d25"))},beforeUpload:function(e,a){if(!g(e))return f.a.error("\u4ec5\u652f\u6301\u4e0a\u4f20.xlsx, .xls, .csv \u6587\u4ef6"),!1},customRequest:function(e){a.readerData(e.file).then((function(){e.onSuccess()}))}}},e.readerData=function(a){return new Promise((function(t,r){var n=new FileReader;n.onload=function(a){var r=a.target.result,n=m.a.read(r,{type:"array"}),c=n.SheetNames[0],s=n.Sheets[c],l=b(s),u=m.a.utils.sheet_to_json(s);e.generateData({header:l,results:u}),t()},n.readAsArrayBuffer(a)}))},e.generateData=function(a){var t=a.header,r=a.results;e.setState({excelData:{header:t,results:r}}),e.props.uploadSuccess&&e.props.uploadSuccess(e.state.excelData)},e}return Object(n.a)(t,[{key:"render",value:function(){return u.a.createElement("div",null,u.a.createElement(v,this.draggerProps(),u.a.createElement("p",{className:"ant-upload-drag-icon"},u.a.createElement(p.a,null)),u.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload")))}}]),t}(l.Component),D=function(e){Object(c.a)(t,e);var a=Object(s.a)(t);function t(){var e;Object(r.a)(this,t);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=a.call.apply(a,[this].concat(c))).state={tableData:[],tableHeader:[]},e.handleSuccess=function(a){var t=a.results,r=a.header;e.setState({tableData:t,tableHeader:r})},e}return Object(n.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"app-container"},u.a.createElement(x,{uploadSuccess:this.handleSuccess}),u.a.createElement("br",null),u.a.createElement(o.a,{bordered:!0,columns:this.state.tableHeader.map((function(e){return{title:e,dataIndex:e,key:e,width:195,align:"center"}})),dataSource:this.state.tableData}))}}]),t}(l.Component);a.default=D},606:function(e,a){},745:function(e,a){},746:function(e,a){}}]);
//# sourceMappingURL=UploadExcel.2500b2d9.chunk.js.map