(this["webpackJsonpsg-demo"]=this["webpackJsonpsg-demo"]||[]).push([[25],{1272:function(e,t,a){"use strict";a.r(t);var n=a(8),i=a(39),l=a(40),r=a(50),c=a(49),s=a(0),o=a.n(s),u=a(1266),d=a(599),m=a(197),h=a(405),f=a(406),b=a(746),g=a(34),p=a(398),E=a(403),y=a(1247),O=a(36);function v(e){return Object(O.a)({url:"/table/list",method:"post",data:e})}function w(e){return Object(O.a)({url:"/table/delete",method:"post",data:e})}function S(e){return Object(O.a)({url:"/table/edit",method:"post",data:e})}var C=a(393),j=a(1270),k=a(1265),D=a(432),M=a.n(D);a(1194);M.a.locale("zh-cn");var I=function(e){Object(r.a)(a,e);var t=Object(c.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onOk,i=e.form,l=e.confirmLoading,r=e.currentRowData,c=i.getFieldDecorator,s=r.id,u=r.author,d=r.date,m=r.readings,g=r.star,p=r.status,E=r.title,y={labelCol:{sm:{span:4}},wrapperCol:{sm:{span:16}}};return o.a.createElement(C.a,{title:"\u7f16\u8f91",visible:t,onCancel:a,onOk:n,confirmLoading:l},o.a.createElement(h.a,y,o.a.createElement(h.a.Item,{label:"\u5e8f\u53f7:"},c("id",{initialValue:s})(o.a.createElement(f.a,{disabled:!0}))),o.a.createElement(h.a.Item,{label:"\u6807\u9898:"},c("title",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898!"}],initialValue:E})(o.a.createElement(f.a,{placeholder:"\u6807\u9898"}))),o.a.createElement(h.a.Item,{label:"\u4f5c\u8005:"},c("author",{initialValue:u})(o.a.createElement(f.a,{disabled:!0}))),o.a.createElement(h.a.Item,{label:"\u9605\u8bfb\u91cf:"},c("readings",{initialValue:m})(o.a.createElement(f.a,{disabled:!0}))),o.a.createElement(h.a.Item,{label:"\u63a8\u8350\u6307\u6570:"},c("star",{initialValue:g.length})(o.a.createElement(j.a,{count:3}))),o.a.createElement(h.a.Item,{label:"\u72b6\u6001:"},c("status",{initialValue:p})(o.a.createElement(b.a,{style:{width:120}},o.a.createElement(b.a.Option,{value:"published"},"published"),o.a.createElement(b.a.Option,{value:"draft"},"draft")))),o.a.createElement(h.a.Item,{label:"\u65f6\u95f4:"},c("date",{rules:[{type:"object",required:!0,message:"\u8bf7\u9009\u62e9\u65f6\u95f4!"}],initialValue:M()(d||"YYYY-MM-DD HH:mm:ss")})(o.a.createElement(k.a,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss"})))))}}]),a}(s.Component),Q=h.a.create({name:"EditForm"})(I),V=u.a.Column,Y=d.a.Panel,z=function(e){Object(r.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(i.a)(this,a);for(var l=arguments.length,r=new Array(l),c=0;c<l;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r)))._isMounted=!1,e.state={list:[],loading:!1,total:0,listQuery:{pageNumber:1,pageSize:10,title:"",star:"",status:""},editModalVisible:!1,editModalLoading:!1,currentRowData:{id:0,author:"",date:"",readings:0,star:"\u2605",status:"published",title:""}},e.fetchData=function(){e.setState({loading:!0}),v(e.state.listQuery).then((function(t){e.setState({loading:!1});var a=t.data.data.items,n=t.data.data.total;e._isMounted&&e.setState({list:a,total:n})}))},e.filterTitleChange=function(t){var a=t.target.value;e.setState((function(e){return{listQuery:Object(n.a)(Object(n.a)({},e.listQuery),{},{title:a})}}))},e.filterStatusChange=function(t){e.setState((function(e){return{listQuery:Object(n.a)(Object(n.a)({},e.listQuery),{},{status:t})}}))},e.filterStarChange=function(t){e.setState((function(e){return{listQuery:Object(n.a)(Object(n.a)({},e.listQuery),{},{star:t})}}))},e.changePage=function(t,a){e.setState((function(e){return{listQuery:Object(n.a)(Object(n.a)({},e.listQuery),{},{pageNumber:t})}}),(function(){e.fetchData()}))},e.changePageSize=function(t,a){e.setState((function(e){return{listQuery:Object(n.a)(Object(n.a)({},e.listQuery),{},{pageNumber:1,pageSize:a})}}),(function(){e.fetchData()}))},e.handleDelete=function(t){w({id:t.id}).then((function(t){m.a.success("\u5220\u9664\u6210\u529f"),e.fetchData()}))},e.handleEdit=function(t){e.setState({currentRowData:Object.assign({},t),editModalVisible:!0})},e.handleOk=function(t){var a=e.formRef.props.form;a.validateFields((function(t,i){if(!t){var l=Object(n.a)(Object(n.a)({},i),{},{star:"".padStart(i.star,"\u2605"),date:i.date.format("YYYY-MM-DD HH:mm:ss")});e.setState({editModalLoading:!0}),S(l).then((function(t){a.resetFields(),e.setState({editModalVisible:!1,editModalLoading:!1}),m.a.success("\u7f16\u8f91\u6210\u529f!"),e.fetchData()})).catch((function(e){m.a.success("\u7f16\u8f91\u5931\u8d25,\u8bf7\u91cd\u8bd5!")}))}}))},e.handleCancel=function(t){e.setState({editModalVisible:!1})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.fetchData()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"app-container"},o.a.createElement(d.a,{defaultActiveKey:["1"]},o.a.createElement(Y,{header:"\u7b5b\u9009",key:"1"},o.a.createElement(h.a,{layout:"inline"},o.a.createElement(h.a.Item,{label:"\u6807\u9898:"},o.a.createElement(f.a,{onChange:this.filterTitleChange})),o.a.createElement(h.a.Item,{label:"\u7c7b\u578b:"},o.a.createElement(b.a,{style:{width:120},onChange:this.filterStatusChange},o.a.createElement(b.a.Option,{value:"published"},"published"),o.a.createElement(b.a.Option,{value:"draft"},"draft"))),o.a.createElement(h.a.Item,{label:"\u63a8\u8350\u6307\u6570:"},o.a.createElement(b.a,{style:{width:120},onChange:this.filterStarChange},o.a.createElement(b.a.Option,{value:1},"\u2605"),o.a.createElement(b.a.Option,{value:2},"\u2605\u2605"),o.a.createElement(b.a.Option,{value:3},"\u2605\u2605\u2605"))),o.a.createElement(h.a.Item,null,o.a.createElement(g.a,{type:"primary",icon:"search",onClick:this.fetchData},"\u641c\u7d22"))))),o.a.createElement("br",null),o.a.createElement(u.a,{bordered:!0,rowKey:function(e){return e.id},dataSource:this.state.list,loading:this.state.loading,pagination:!1},o.a.createElement(V,{title:"\u5e8f\u53f7",dataIndex:"id",key:"id",width:200,align:"center",sorter:function(e,t){return e.id-t.id}}),o.a.createElement(V,{title:"\u6807\u9898",dataIndex:"title",key:"title",width:200,align:"center"}),o.a.createElement(V,{title:"\u4f5c\u8005",dataIndex:"author",key:"author",width:100,align:"center"}),o.a.createElement(V,{title:"\u9605\u8bfb\u91cf",dataIndex:"readings",key:"readings",width:195,align:"center"}),o.a.createElement(V,{title:"\u63a8\u8350\u6307\u6570",dataIndex:"star",key:"star",width:195,align:"center"}),o.a.createElement(V,{title:"\u72b6\u6001",dataIndex:"status",key:"status",width:195,align:"center",render:function(e){var t="published"===e?"green":"deleted"===e?"red":"";return o.a.createElement(p.a,{color:t,key:e},e)}}),o.a.createElement(V,{title:"\u65f6\u95f4",dataIndex:"date",key:"date",width:195,align:"center"}),o.a.createElement(V,{title:"\u64cd\u4f5c",key:"action",width:195,align:"center",render:function(t,a){return o.a.createElement("span",null,o.a.createElement(g.a,{type:"primary",shape:"circle",icon:"edit",title:"\u7f16\u8f91",onClick:e.handleEdit.bind(null,a)}),o.a.createElement(E.a,{type:"vertical"}),o.a.createElement(g.a,{type:"primary",shape:"circle",icon:"delete",title:"\u5220\u9664",onClick:e.handleDelete.bind(null,a)}))}})),o.a.createElement("br",null),o.a.createElement(y.a,{total:this.state.total,pageSizeOptions:["10","20","40"],showTotal:function(e){return"\u5171".concat(e,"\u6761\u6570\u636e")},onChange:this.changePage,current:this.state.listQuery.pageNumber,onShowSizeChange:this.changePageSize,showSizeChanger:!0,showQuickJumper:!0,hideOnSinglePage:!0}),o.a.createElement(Q,{currentRowData:this.state.currentRowData,wrappedComponentRef:function(t){return e.formRef=t},visible:this.state.editModalVisible,confirmLoading:this.state.editModalLoading,onCancel:this.handleCancel,onOk:this.handleOk}))}}]),a}(s.Component);t.default=z}}]);
//# sourceMappingURL=Table.6061c1de.chunk.js.map