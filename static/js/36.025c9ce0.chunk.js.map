{"version":3,"sources":["lib/Export2Excel.js","webpack:///./node_modules/file-saver/dist/FileSaver.min.js?e8ea","../node_modules/script-loader/addScript.js","../node_modules/file-saver/dist/FileSaver.min.js"],"names":["sheet_from_array_of_arrays","data","opts","v","ws","range","s","c","r","e","R","length","C","cell","cell_ref","XLSX","utils","encode_cell","t","Date","z","SSF","_table","datenum","parse","UTC","encode_range","Workbook","this","SheetNames","Sheets","s2ab","buf","ArrayBuffer","view","Uint8Array","i","charCodeAt","export_table_to_excel","id","oo","table","out","rows","querySelectorAll","ranges","outRow","columns","colspan","getAttribute","rowspan","cellValue","innerText","forEach","push","k","generateArray","document","getElementById","wb","wbout","write","bookType","bookSST","type","saveAs","Blob","export_json_to_excel","multiHeader","header","filename","merges","autoWidth","unshift","ws_name","item","decode_range","colWidth","map","row","val","toString","result","j","require","module","exports","src","log","error","console","execScript","attachEvent","addEventListener","eval","call"],"mappings":"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","file":"static/js/36.025c9ce0.chunk.js","sourcesContent":["/* eslint-disable */\r\nrequire('script-loader!file-saver');\r\nimport XLSX from 'xlsx'\r\n\r\nfunction generateArray(table) {\r\n  var out = [];\r\n  var rows = table.querySelectorAll('tr');\r\n  var ranges = [];\r\n  for (var R = 0; R < rows.length; ++R) {\r\n    var outRow = [];\r\n    var row = rows[R];\r\n    var columns = row.querySelectorAll('td');\r\n    for (var C = 0; C < columns.length; ++C) {\r\n      var cell = columns[C];\r\n      var colspan = cell.getAttribute('colspan');\r\n      var rowspan = cell.getAttribute('rowspan');\r\n      var cellValue = cell.innerText;\r\n      if (cellValue !== \"\" && cellValue == +cellValue) cellValue = +cellValue;\r\n\r\n      //Skip ranges\r\n      ranges.forEach(function (range) {\r\n        if (R >= range.s.r && R <= range.e.r && outRow.length >= range.s.c && outRow.length <= range.e.c) {\r\n          for (var i = 0; i <= range.e.c - range.s.c; ++i) outRow.push(null);\r\n        }\r\n      });\r\n\r\n      //Handle Row Span\r\n      if (rowspan || colspan) {\r\n        rowspan = rowspan || 1;\r\n        colspan = colspan || 1;\r\n        ranges.push({\r\n          s: {\r\n            r: R,\r\n            c: outRow.length\r\n          },\r\n          e: {\r\n            r: R + rowspan - 1,\r\n            c: outRow.length + colspan - 1\r\n          }\r\n        });\r\n      };\r\n\r\n      //Handle Value\r\n      outRow.push(cellValue !== \"\" ? cellValue : null);\r\n\r\n      //Handle Colspan\r\n      if (colspan)\r\n        for (var k = 0; k < colspan - 1; ++k) outRow.push(null);\r\n    }\r\n    out.push(outRow);\r\n  }\r\n  return [out, ranges];\r\n};\r\n\r\nfunction datenum(v, date1904) {\r\n  if (date1904) v += 1462;\r\n  var epoch = Date.parse(v);\r\n  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\r\n}\r\n\r\nfunction sheet_from_array_of_arrays(data, opts) {\r\n  var ws = {};\r\n  var range = {\r\n    s: {\r\n      c: 10000000,\r\n      r: 10000000\r\n    },\r\n    e: {\r\n      c: 0,\r\n      r: 0\r\n    }\r\n  };\r\n  for (var R = 0; R != data.length; ++R) {\r\n    for (var C = 0; C != data[R].length; ++C) {\r\n      if (range.s.r > R) range.s.r = R;\r\n      if (range.s.c > C) range.s.c = C;\r\n      if (range.e.r < R) range.e.r = R;\r\n      if (range.e.c < C) range.e.c = C;\r\n      var cell = {\r\n        v: data[R][C]\r\n      };\r\n      if (cell.v == null) continue;\r\n      var cell_ref = XLSX.utils.encode_cell({\r\n        c: C,\r\n        r: R\r\n      });\r\n\r\n      if (typeof cell.v === 'number') cell.t = 'n';\r\n      else if (typeof cell.v === 'boolean') cell.t = 'b';\r\n      else if (cell.v instanceof Date) {\r\n        cell.t = 'n';\r\n        cell.z = XLSX.SSF._table[14];\r\n        cell.v = datenum(cell.v);\r\n      } else cell.t = 's';\r\n\r\n      ws[cell_ref] = cell;\r\n    }\r\n  }\r\n  if (range.s.c < 10000000) ws['!ref'] = XLSX.utils.encode_range(range);\r\n  return ws;\r\n}\r\n\r\nfunction Workbook() {\r\n  if (!(this instanceof Workbook)) return new Workbook();\r\n  this.SheetNames = [];\r\n  this.Sheets = {};\r\n}\r\n\r\nfunction s2ab(s) {\r\n  var buf = new ArrayBuffer(s.length);\r\n  var view = new Uint8Array(buf);\r\n  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\r\n  return buf;\r\n}\r\n\r\nexport function export_table_to_excel(id) {\r\n  var theTable = document.getElementById(id);\r\n  var oo = generateArray(theTable);\r\n  var ranges = oo[1];\r\n\r\n  /* original data */\r\n  var data = oo[0];\r\n  var ws_name = \"SheetJS\";\r\n\r\n  var wb = new Workbook(),\r\n    ws = sheet_from_array_of_arrays(data);\r\n\r\n  /* add ranges to worksheet */\r\n  // ws['!cols'] = ['apple', 'banan'];\r\n  ws['!merges'] = ranges;\r\n\r\n  /* add worksheet to workbook */\r\n  wb.SheetNames.push(ws_name);\r\n  wb.Sheets[ws_name] = ws;\r\n\r\n  var wbout = XLSX.write(wb, {\r\n    bookType: 'xlsx',\r\n    bookSST: false,\r\n    type: 'binary'\r\n  });\r\n\r\n  saveAs(new Blob([s2ab(wbout)], {\r\n    type: \"application/octet-stream\"\r\n  }), \"test.xlsx\")\r\n}\r\n\r\nexport function export_json_to_excel({\r\n  multiHeader = [],\r\n  header,\r\n  data,\r\n  filename,\r\n  merges = [],\r\n  autoWidth = true,\r\n  bookType=  'xlsx'\r\n} = {}) {\r\n  /* original data */\r\n  filename = filename || 'excel-list'\r\n  data = [...data]\r\n  data.unshift(header);\r\n\r\n  for (let i = multiHeader.length-1; i > -1; i--) {\r\n    data.unshift(multiHeader[i])\r\n  }\r\n\r\n  var ws_name = \"SheetJS\";\r\n  var wb = new Workbook(),\r\n    ws = sheet_from_array_of_arrays(data);\r\n\r\n  if (merges.length > 0) {\r\n    if (!ws['!merges']) ws['!merges'] = [];\r\n    merges.forEach(item => {\r\n      ws['!merges'].push(XLSX.utils.decode_range(item))\r\n    })\r\n  }\r\n\r\n  if (autoWidth) {\r\n    /*设置worksheet每列的最大宽度*/\r\n    const colWidth = data.map(row => row.map(val => {\r\n      /*先判断是否为null/undefined*/\r\n      if (val == null) {\r\n        return {\r\n          'wch': 10\r\n        };\r\n      }\r\n      /*再判断是否为中文*/\r\n      else if (val.toString().charCodeAt(0) > 255) {\r\n        return {\r\n          'wch': val.toString().length * 2\r\n        };\r\n      } else {\r\n        return {\r\n          'wch': val.toString().length\r\n        };\r\n      }\r\n    }))\r\n    /*以第一行为初始值*/\r\n    let result = colWidth[0];\r\n    for (let i = 1; i < colWidth.length; i++) {\r\n      for (let j = 0; j < colWidth[i].length; j++) {\r\n        if (result[j]['wch'] < colWidth[i][j]['wch']) {\r\n          result[j]['wch'] = colWidth[i][j]['wch'];\r\n        }\r\n      }\r\n    }\r\n    ws['!cols'] = result;\r\n  }\r\n\r\n  /* add worksheet to workbook */\r\n  wb.SheetNames.push(ws_name);\r\n  wb.Sheets[ws_name] = ws;\r\n\r\n  var wbout = XLSX.write(wb, {\r\n    bookType: bookType,\r\n    bookSST: false,\r\n    type: 'binary'\r\n  });\r\n  saveAs(new Blob([s2ab(wbout)], {\r\n    type: \"application/octet-stream\"\r\n  }), `${filename}.${bookType}`);\r\n}\r\n","require(\"!!C:\\\\Users\\\\Dylan\\\\Repo\\\\react-playground\\\\projects\\\\sg-demo\\\\node_modules\\\\script-loader\\\\addScript.js\")(require(\"!!C:\\\\Users\\\\Dylan\\\\Repo\\\\react-playground\\\\projects\\\\sg-demo\\\\node_modules\\\\raw-loader\\\\index.js!C:\\\\Users\\\\Dylan\\\\Repo\\\\react-playground\\\\projects\\\\sg-demo\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js??ref--6-oneOf-2!C:\\\\Users\\\\Dylan\\\\Repo\\\\react-playground\\\\projects\\\\sg-demo\\\\node_modules\\\\file-saver\\\\dist\\\\FileSaver.min.js\"))","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nmodule.exports = function(src) {\n\tfunction log(error) {\n\t\t(typeof console !== \"undefined\")\n\t\t&& (console.error || console.log)(\"[Script Loader]\", error);\n\t}\n\n\t// Check for IE =< 8\n\tfunction isIE() {\n\t\treturn typeof attachEvent !== \"undefined\" && typeof addEventListener === \"undefined\";\n\t}\n\n\ttry {\n\t\tif (typeof execScript !== \"undefined\" && isIE()) {\n\t\t\texecScript(src);\n\t\t} else if (typeof eval !== \"undefined\") {\n\t\t\teval.call(null, src);\n\t\t} else {\n\t\t\tlog(\"EvalError: No eval function available\");\n\t\t}\n\t} catch (error) {\n\t\tlog(error);\n\t}\n}\n","module.exports = \"(function (a, b) {\\n  if (\\\"function\\\" == typeof define && define.amd) define([], b);else if (\\\"undefined\\\" != typeof exports) b();else {\\n    b(), a.FileSaver = {\\n      exports: {}\\n    }.exports;\\n  }\\n})(this, function () {\\n  \\\"use strict\\\";\\n\\n  function b(a, b) {\\n    return \\\"undefined\\\" == typeof b ? b = {\\n      autoBom: !1\\n    } : \\\"object\\\" != typeof b && (console.warn(\\\"Deprecated: Expected third argument to be a object\\\"), b = {\\n      autoBom: !b\\n    }), b.autoBom && /^\\\\s*(?:text\\\\/\\\\S*|application\\\\/xml|\\\\S*\\\\/\\\\S*\\\\+xml)\\\\s*;.*charset\\\\s*=\\\\s*utf-8/i.test(a.type) ? new Blob([\\\"\\\\uFEFF\\\", a], {\\n      type: a.type\\n    }) : a;\\n  }\\n\\n  function c(b, c, d) {\\n    var e = new XMLHttpRequest();\\n    e.open(\\\"GET\\\", b), e.responseType = \\\"blob\\\", e.onload = function () {\\n      a(e.response, c, d);\\n    }, e.onerror = function () {\\n      console.error(\\\"could not download file\\\");\\n    }, e.send();\\n  }\\n\\n  function d(a) {\\n    var b = new XMLHttpRequest();\\n    b.open(\\\"HEAD\\\", a, !1);\\n\\n    try {\\n      b.send();\\n    } catch (a) {}\\n\\n    return 200 <= b.status && 299 >= b.status;\\n  }\\n\\n  function e(a) {\\n    try {\\n      a.dispatchEvent(new MouseEvent(\\\"click\\\"));\\n    } catch (c) {\\n      var b = document.createEvent(\\\"MouseEvents\\\");\\n      b.initMouseEvent(\\\"click\\\", !0, !0, window, 0, 0, 0, 80, 20, !1, !1, !1, !1, 0, null), a.dispatchEvent(b);\\n    }\\n  }\\n\\n  var f = \\\"object\\\" == typeof window && window.window === window ? window : \\\"object\\\" == typeof self && self.self === self ? self : \\\"object\\\" == typeof global && global.global === global ? global : void 0,\\n      a = f.saveAs || (\\\"object\\\" != typeof window || window !== f ? function () {} : \\\"download\\\" in HTMLAnchorElement.prototype ? function (b, g, h) {\\n    var i = f.URL || f.webkitURL,\\n        j = document.createElement(\\\"a\\\");\\n    g = g || b.name || \\\"download\\\", j.download = g, j.rel = \\\"noopener\\\", \\\"string\\\" == typeof b ? (j.href = b, j.origin === location.origin ? e(j) : d(j.href) ? c(b, g, h) : e(j, j.target = \\\"_blank\\\")) : (j.href = i.createObjectURL(b), setTimeout(function () {\\n      i.revokeObjectURL(j.href);\\n    }, 4E4), setTimeout(function () {\\n      e(j);\\n    }, 0));\\n  } : \\\"msSaveOrOpenBlob\\\" in navigator ? function (f, g, h) {\\n    if (g = g || f.name || \\\"download\\\", \\\"string\\\" != typeof f) navigator.msSaveOrOpenBlob(b(f, h), g);else if (d(f)) c(f, g, h);else {\\n      var i = document.createElement(\\\"a\\\");\\n      i.href = f, i.target = \\\"_blank\\\", setTimeout(function () {\\n        e(i);\\n      });\\n    }\\n  } : function (a, b, d, e) {\\n    if (e = e || open(\\\"\\\", \\\"_blank\\\"), e && (e.document.title = e.document.body.innerText = \\\"downloading...\\\"), \\\"string\\\" == typeof a) return c(a, b, d);\\n    var g = \\\"application/octet-stream\\\" === a.type,\\n        h = /constructor/i.test(f.HTMLElement) || f.safari,\\n        i = /CriOS\\\\/[\\\\d]+/.test(navigator.userAgent);\\n\\n    if ((i || g && h) && \\\"object\\\" == typeof FileReader) {\\n      var j = new FileReader();\\n      j.onloadend = function () {\\n        var a = j.result;\\n        a = i ? a : a.replace(/^data:[^;]*;/, \\\"data:attachment/file;\\\"), e ? e.location.href = a : location = a, e = null;\\n      }, j.readAsDataURL(a);\\n    } else {\\n      var k = f.URL || f.webkitURL,\\n          l = k.createObjectURL(a);\\n      e ? e.location = l : location.href = l, e = null, setTimeout(function () {\\n        k.revokeObjectURL(l);\\n      }, 4E4);\\n    }\\n  });\\n  f.saveAs = a.saveAs = a, \\\"undefined\\\" != typeof module && (module.exports = a);\\n});\""],"sourceRoot":""}